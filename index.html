<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Daily Polygon DApp</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/@thirdweb-dev/sdk@latest/dist/thirdweb-sdk.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/thirdweb-react@latest/dist/thirdweb-react.min.js"></script>
</head>
<body>
    <header>
        <h1>Daily Polygon</h1>
    </header>
    <main>
        <button id="connectButton">Connect Wallet</button>
        <p>Your Address: <span id="walletAddress">Not Connected</span></p>
        <section id="investment">
            <h2>Invest for Daily Income</h2>
            <form id="investmentForm">
                <label for="amount">Amount (POL):</label>
                <input type="number" id="amount" min="1" step="0.01" required>
                <button type="submit">Invest</button>
            </form>
        </section>
    </main>
    
    <footer>
        <p>&copy; 2024 Daily Polygon DApp</p>
    </footer>

    <script>
        const { createThirdwebClient, ConnectButton, ThirdwebProvider } = window.Thirdweb;

        const client = createThirdwebClient({
            clientId: "aa83552f8db8c2d86a9c06a13e113b0e", // Replace with your clientId
        });

        async function connectWallet() {
            const wallets = [
              createWallet("io.metamask"),
              createWallet("com.coinbase.wallet"),
              createWallet("me.rainbow"),
              createWallet("com.trustwallet.app"),
              createWallet("com.okex.wallet"),
              createWallet("com.safepal"),
              createWallet("pro.tokenpocket"),
              createWallet("com.bitget.web3"),
            ];

            const connectButton = new ConnectButton({
                client,
                wallets,
            });

            await client.connect(wallets);
        const signer = client.getSigner();
        const address = await signer.getAddress();
        document.getElementById('walletAddress').innerText = address;
    }

    document.getElementById('connectButton').onclick = connectWallet;

    document.getElementById('investmentForm').onsubmit = async (e) => {
        e.preventDefault();
        const amount = document.getElementById('amount').value;

        try {
            const contract = await client.getContract("0x0d7A25d695952E8815f6aE99c210Dee687528679"); // Your contract address
            const referrer = ""; // Get referrer address if needed

            // Call the invest function on the smart contract
            const tx = await contract.call("invest", referrer, {
                value: client.utils.parseUnits(amount, 'ether') // Convert POL to wei
            });
            await tx.wait(); // Wait for the transaction to be mined
            console.log(`Successfully invested ${amount} POL`);
        } catch (error) {
            console.error("Investment failed:", error);
        }
        };
    </script>
</body>
</html>
